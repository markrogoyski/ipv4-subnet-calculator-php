<?php

declare(strict_types=1);

namespace IPv4\Tests;

use IPv4\Subnet;
use PHPUnit\Framework\Attributes\DataProvider;
use PHPUnit\Framework\Attributes\Test;

class SubnetNetworkTest extends \PHPUnit\Framework\TestCase
{
    /** @var Subnet */
    private $sub;

    /**
     * Set up test Subnet
     */
    public function setUp(): void
    {
        $this->sub = new Subnet('192.168.112.203', 23);
    }

    /**
     * getNumberIpAddresses returns the number of IP addresses
     * @param        string $ip_address
     * @param        int    $network_size
     * @param        int    $expected_number_addresses
     */
    #[Test]
    #[DataProvider('dataProviderForNumberOfAddresses')]
    public function testGetNumberIPAddresses(string $ip_address, int $network_size, int $expected_number_addresses): void
    {
        // Given
        $sub = new Subnet($ip_address, $network_size);

        // When
        $number_addresses = $sub->addressCount();

        // Then
        $this->assertEquals($expected_number_addresses, $number_addresses);
    }

    /**
     * @return array[] [ip_address, network_size, number_addresses]
     */
    public static function dataProviderForNumberOfAddresses(): array
    {
        return [
            ['0.0.0.0', 0, 4_294_967_296],  // /0 = entire IPv4 space
            ['192.168.112.203', 1,  2147483648],
            ['192.168.112.203', 2, 1073741824],
            ['192.168.112.203', 3, 536870912],
            ['192.168.112.203', 4, 268435456],
            ['192.168.112.203', 5, 134217728],
            ['192.168.112.203', 6, 67108864],
            ['192.168.112.203', 7, 33554432],
            ['192.168.112.203', 8, 16777216],
            ['192.168.112.203', 9, 8388608],
            ['192.168.112.203', 10, 4194304],
            ['192.168.112.203', 11, 2097152],
            ['192.168.112.203', 12, 1048576],
            ['192.168.112.203', 13, 524288],
            ['192.168.112.203', 14, 262144],
            ['192.168.112.203', 15, 131072],
            ['192.168.112.203', 16, 65536],
            ['192.168.112.203', 17, 32768],
            ['192.168.112.203', 18, 16384],
            ['192.168.112.203', 19, 8192],
            ['192.168.112.203', 20, 4096],
            ['192.168.112.203', 21, 2048],
            ['192.168.112.203', 22, 1024],
            ['192.168.112.203', 23, 512],
            ['192.168.112.203', 24, 256],
            ['192.168.112.203', 25, 128],
            ['192.168.112.203', 26, 64],
            ['192.168.112.203', 27, 32],
            ['192.168.112.203', 28, 16],
            ['192.168.112.203', 29, 8],
            ['192.168.112.203', 30, 4],
            ['192.168.112.203', 31, 2],
            ['192.168.112.203', 32, 1],
        ];
    }

    /**
     * getNumberAddressableHosts returns the number of IP addresses
     * @param        string $ip_address
     * @param        int    $network_size
     * @param        int    $expected_number_addressable_hosts
     */
    #[Test]
    #[DataProvider('dataProviderForNumberOfAddressableHosts')]
    public function testGetNumberAddressableHosts(string $ip_address, int $network_size, int $expected_number_addressable_hosts): void
    {
        // Given
        $sub = new Subnet($ip_address, $network_size);

        // When
        $number_addressable_hosts = $sub->hostCount();

        // Then
        $this->assertEquals($expected_number_addressable_hosts, $number_addressable_hosts);
    }

    /**
     * @return array[] [ip_address, network_size, number_addressable_hosts]
     */
    public static function dataProviderForNumberOfAddressableHosts(): array
    {
        return [
            ['0.0.0.0', 0, 4_294_967_294],  // /0 = entire IPv4 space minus network and broadcast
            ['192.168.112.203', 1, 2147483646],
            ['192.168.112.203', 2, 1073741822],
            ['192.168.112.203', 3, 536870910],
            ['192.168.112.203', 4, 268435454],
            ['192.168.112.203', 5, 134217726],
            ['192.168.112.203', 6, 67108862],
            ['192.168.112.203', 7, 33554430],
            ['192.168.112.203', 8, 16777214],
            ['192.168.112.203', 9, 8388606],
            ['192.168.112.203', 10, 4194302],
            ['192.168.112.203', 11, 2097150],
            ['192.168.112.203', 12, 1048574],
            ['192.168.112.203', 13, 524286],
            ['192.168.112.203', 14, 262142],
            ['192.168.112.203', 15, 131070],
            ['192.168.112.203', 16, 65534],
            ['192.168.112.203', 17, 32766],
            ['192.168.112.203', 18, 16382],
            ['192.168.112.203', 19, 8190],
            ['192.168.112.203', 20, 4094],
            ['192.168.112.203', 21, 2046],
            ['192.168.112.203', 22, 1022],
            ['192.168.112.203', 23, 510],
            ['192.168.112.203', 24, 254],
            ['192.168.112.203', 25, 126],
            ['192.168.112.203', 26, 62],
            ['192.168.112.203', 27, 30],
            ['192.168.112.203', 28, 14],
            ['192.168.112.203', 29, 6],
            ['192.168.112.203', 30, 2],
            ['192.168.112.203', 31, 2],
            ['192.168.112.203', 32, 1],
        ];
    }

    /**
     * getIpAddressRange returns the lower and upper IP addresses in the range
     * @param        string $ip_address
     * @param        int    $network_size
     * @param        string $expected_lower_ip
     * @param        string $expected_upper_ip
     */
    #[Test]
    #[DataProvider('dataProviderForIpAddressRange')]
    public function testGetIpAddressRange(string $ip_address, int $network_size, string $expected_lower_ip, string $expected_upper_ip): void
    {
        // Given
        $sub = new Subnet($ip_address, $network_size);

        // When
        $lower_ip = $sub->addressRange()->start()->asQuads();
        $upper_ip = $sub->addressRange()->end()->asQuads();

        // Then
        $this->assertEquals($expected_lower_ip, $lower_ip);
        $this->assertEquals($expected_upper_ip, $upper_ip);
    }

    /**
     * getNetworkPortion
     * @param        string $ip_address
     * @param        int    $network_size
     * @param        string $expected_network_portion
     */
    #[Test]
    #[DataProvider('dataProviderForIpAddressRange')]
    public function testGetNetworkPortionLowerIp(string $ip_address, int $network_size, string $expected_network_portion): void
    {
        // Given
        $sub = new Subnet($ip_address, $network_size);

        // When
        $network_portion = $sub->networkPortion()->asQuads();

        // Then
        $this->assertEquals($expected_network_portion, $network_portion);
    }

    /**
     * @return array[] [ip_address, network_size, lower_ip, upper_ip]
     */
    public static function dataProviderForIpAddressRange(): array
    {
        return [
            ['192.168.112.203', 1, '128.0.0.0', '255.255.255.255'],
            ['192.168.112.203', 2, '192.0.0.0', '255.255.255.255'],
            ['192.168.112.203', 3, '192.0.0.0', '223.255.255.255'],
            ['192.168.112.203', 4, '192.0.0.0', '207.255.255.255'],
            ['192.168.112.203', 5, '192.0.0.0', '199.255.255.255'],
            ['192.168.112.203', 6, '192.0.0.0', '195.255.255.255'],
            ['192.168.112.203', 7, '192.0.0.0', '193.255.255.255'],
            ['192.168.112.203', 8, '192.0.0.0', '192.255.255.255'],
            ['192.168.112.203', 9, '192.128.0.0', '192.255.255.255'],
            ['192.168.112.203', 10, '192.128.0.0', '192.191.255.255'],
            ['192.168.112.203', 11, '192.160.0.0', '192.191.255.255'],
            ['192.168.112.203', 12, '192.160.0.0', '192.175.255.255'],
            ['192.168.112.203', 13, '192.168.0.0', '192.175.255.255'],
            ['192.168.112.203', 14, '192.168.0.0', '192.171.255.255'],
            ['192.168.112.203', 15, '192.168.0.0', '192.169.255.255'],
            ['192.168.112.203', 16, '192.168.0.0', '192.168.255.255'],
            ['192.168.112.203', 17, '192.168.0.0', '192.168.127.255'],
            ['192.168.112.203', 18, '192.168.64.0', '192.168.127.255'],
            ['192.168.112.203', 19, '192.168.96.0', '192.168.127.255'],
            ['192.168.112.203', 20, '192.168.112.0', '192.168.127.255'],
            ['192.168.112.203', 21, '192.168.112.0', '192.168.119.255'],
            ['192.168.112.203', 22, '192.168.112.0', '192.168.115.255'],
            ['192.168.112.203', 23, '192.168.112.0', '192.168.113.255'],
            ['192.168.112.203', 24, '192.168.112.0', '192.168.112.255'],
            ['192.168.112.203', 25, '192.168.112.128', '192.168.112.255'],
            ['192.168.112.203', 26, '192.168.112.192', '192.168.112.255'],
            ['192.168.112.203', 27, '192.168.112.192', '192.168.112.223'],
            ['192.168.112.203', 28, '192.168.112.192', '192.168.112.207'],
            ['192.168.112.203', 29, '192.168.112.200', '192.168.112.207'],
            ['192.168.112.203', 30, '192.168.112.200', '192.168.112.203'],
            ['192.168.112.203', 31, '192.168.112.202', '192.168.112.203'],
            ['192.168.112.203', 32, '192.168.112.203', '192.168.112.203'],
        ];
    }

    /**
     * getBroadcastAddress returns the broadcast address
     * @param        string $ip_address
     * @param        int    $network_size
     * @param        string $expected_broadcast_address
     */
    #[Test]
    #[DataProvider('dataProviderForBroadcastAddress')]
    public function testGetBroadcastAddress(string $ip_address, int $network_size, string $expected_broadcast_address): void
    {
        // Given
        $sub = new Subnet($ip_address, $network_size);

        // When
        $broadcast_address = $sub->broadcastAddress()->asQuads();

        // Then
        $this->assertEquals($expected_broadcast_address, $broadcast_address);
    }

    /**
     * @return array[] [ip_address, network_size, broadcast_address]
     */
    public static function dataProviderForBroadcastAddress(): array
    {
        return [
            ['192.168.112.203', 1, '255.255.255.255'],
            ['192.168.112.203', 2, '255.255.255.255'],
            ['192.168.112.203', 3, '223.255.255.255'],
            ['192.168.112.203', 4, '207.255.255.255'],
            ['192.168.112.203', 5, '199.255.255.255'],
            ['192.168.112.203', 6, '195.255.255.255'],
            ['192.168.112.203', 7, '193.255.255.255'],
            ['192.168.112.203', 8, '192.255.255.255'],
            ['192.168.112.203', 9, '192.255.255.255'],
            ['192.168.112.203', 10, '192.191.255.255'],
            ['192.168.112.203', 11, '192.191.255.255'],
            ['192.168.112.203', 12, '192.175.255.255'],
            ['192.168.112.203', 13, '192.175.255.255'],
            ['192.168.112.203', 14, '192.171.255.255'],
            ['192.168.112.203', 15, '192.169.255.255'],
            ['192.168.112.203', 16, '192.168.255.255'],
            ['192.168.112.203', 17, '192.168.127.255'],
            ['192.168.112.203', 18, '192.168.127.255'],
            ['192.168.112.203', 19, '192.168.127.255'],
            ['192.168.112.203', 20, '192.168.127.255'],
            ['192.168.112.203', 21, '192.168.119.255'],
            ['192.168.112.203', 22, '192.168.115.255'],
            ['192.168.112.203', 23, '192.168.113.255'],
            ['192.168.112.203', 24, '192.168.112.255'],
            ['192.168.112.203', 25, '192.168.112.255'],
            ['192.168.112.203', 26, '192.168.112.255'],
            ['192.168.112.203', 27, '192.168.112.223'],
            ['192.168.112.203', 28, '192.168.112.207'],
            ['192.168.112.203', 29, '192.168.112.207'],
            ['192.168.112.203', 30, '192.168.112.203'],
            ['192.168.112.203', 31, '192.168.112.203'],
            ['192.168.112.203', 32, '192.168.112.203'],
        ];
    }

    /**
     * getSubnetMask
     * @param        int      $network_size
     * @param        string   $subnet_mask
     * @param        string[] $quads
     * @param        string   $hex
     * @param        string   $binary
     * @param        int      $integer
     */
    #[Test]
    #[DataProvider('dataProviderForSubnetMask')]
    public function testGetSubnetMask(int $network_size, string $subnet_mask, array $quads, string $hex, string $binary, int $integer): void
    {
        // Given
        $sub = new Subnet('192.168.233.207', $network_size);

        // Then
        $this->assertSame($subnet_mask, $sub->mask()->asQuads());
        $this->assertSame($quads, $sub->mask()->asArray());
        $this->assertSame($hex, $sub->mask()->asHex());
        $this->assertSame($binary, $sub->mask()->asBinary());
        $this->assertSame($integer, $sub->mask()->asInteger());
    }

    /**
     * @return array[] [network size, subnet mask, hex, binary, integer]
     */
    public static function dataProviderForSubnetMask(): array
    {
        return [
            [1, '128.0.0.0', ['128', '0', '0', '0'], '80000000', '10000000000000000000000000000000', 2147483648],
            [2, '192.0.0.0', ['192', '0', '0', '0'], 'C0000000', '11000000000000000000000000000000', 3221225472],
            [3, '224.0.0.0', ['224', '0', '0', '0'], 'E0000000', '11100000000000000000000000000000', 3758096384],
            [4, '240.0.0.0', ['240', '0', '0', '0'], 'F0000000', '11110000000000000000000000000000', 4026531840],
            [5, '248.0.0.0', ['248', '0', '0', '0'], 'F8000000', '11111000000000000000000000000000', 4160749568],
            [6, '252.0.0.0', ['252', '0', '0', '0'], 'FC000000', '11111100000000000000000000000000', 4227858432],
            [7, '254.0.0.0', ['254', '0', '0', '0'], 'FE000000', '11111110000000000000000000000000', 4261412864],
            [8, '255.0.0.0', ['255', '0', '0', '0'], 'FF000000', '11111111000000000000000000000000', 4278190080],
            [9, '255.128.0.0', ['255', '128', '0', '0'], 'FF800000', '11111111100000000000000000000000', 4286578688],
            [10, '255.192.0.0', ['255', '192', '0', '0'], 'FFC00000', '11111111110000000000000000000000', 4290772992],
            [11, '255.224.0.0', ['255', '224', '0', '0'], 'FFE00000', '11111111111000000000000000000000', 4292870144],
            [12, '255.240.0.0', ['255', '240', '0', '0'], 'FFF00000', '11111111111100000000000000000000', 4293918720],
            [13, '255.248.0.0', ['255', '248', '0', '0'], 'FFF80000', '11111111111110000000000000000000', 4294443008],
            [14, '255.252.0.0', ['255', '252', '0', '0'], 'FFFC0000', '11111111111111000000000000000000', 4294705152],
            [15, '255.254.0.0', ['255', '254', '0', '0'], 'FFFE0000', '11111111111111100000000000000000', 4294836224],
            [16, '255.255.0.0', ['255', '255', '0', '0'], 'FFFF0000', '11111111111111110000000000000000', 4294901760],
            [17, '255.255.128.0', ['255', '255', '128', '0'], 'FFFF8000', '11111111111111111000000000000000', 4294934528],
            [18, '255.255.192.0', ['255', '255', '192', '0'], 'FFFFC000', '11111111111111111100000000000000', 4294950912],
            [19, '255.255.224.0', ['255', '255', '224', '0'], 'FFFFE000', '11111111111111111110000000000000', 4294959104],
            [20, '255.255.240.0', ['255', '255', '240', '0'], 'FFFFF000', '11111111111111111111000000000000', 4294963200],
            [21, '255.255.248.0', ['255', '255', '248', '0'], 'FFFFF800', '11111111111111111111100000000000', 4294965248],
            [22, '255.255.252.0', ['255', '255', '252', '0'], 'FFFFFC00', '11111111111111111111110000000000', 4294966272],
            [23, '255.255.254.0', ['255', '255', '254', '0'], 'FFFFFE00', '11111111111111111111111000000000', 4294966784],
            [24, '255.255.255.0', ['255', '255', '255', '0'], 'FFFFFF00', '11111111111111111111111100000000', 4294967040],
            [25, '255.255.255.128', ['255', '255', '255', '128'], 'FFFFFF80', '11111111111111111111111110000000', 4294967168],
            [26, '255.255.255.192', ['255', '255', '255', '192'], 'FFFFFFC0', '11111111111111111111111111000000', 4294967232],
            [27, '255.255.255.224', ['255', '255', '255', '224'], 'FFFFFFE0', '11111111111111111111111111100000', 4294967264],
            [28, '255.255.255.240', ['255', '255', '255', '240'], 'FFFFFFF0', '11111111111111111111111111110000', 4294967280],
            [29, '255.255.255.248', ['255', '255', '255', '248'], 'FFFFFFF8', '11111111111111111111111111111000', 4294967288],
            [30, '255.255.255.252', ['255', '255', '255', '252'], 'FFFFFFFC', '11111111111111111111111111111100', 4294967292],
            [31, '255.255.255.254', ['255', '255', '255', '254'], 'FFFFFFFE', '11111111111111111111111111111110', 4294967294],
            [32, '255.255.255.255', ['255', '255', '255', '255'], 'FFFFFFFF', '11111111111111111111111111111111', 4294967295],
        ];
    }

    /**
     * getHostPortion
     * @param        string   $ip_address
     * @param        int      $network_size
     * @param        string   $network
     * @param        string[] $quads
     * @param        string   $hex
     * @param        string   $binary
     * @param        int      $integer
     */
    #[Test]
    #[DataProvider('dataProviderForNetworkPortion')]
    public function testGetNetworkPortion(string $ip_address, int $network_size, string $network, array $quads, string $hex, string $binary, int $integer): void
    {
        // Given
        $sub = new Subnet($ip_address, $network_size);

        // Then
        $this->assertSame($network, $sub->networkPortion()->asQuads());
        $this->assertSame($quads, $sub->networkPortion()->asArray());
        $this->assertSame($hex, $sub->networkPortion()->asHex());
        $this->assertSame($binary, $sub->networkPortion()->asBinary());
        $this->assertSame($integer, $sub->networkPortion()->asInteger());
    }

    /**
     * @return array[] [ip_address, network_size, network, quads, hex, binary, integer]
     */
    public static function dataProviderForNetworkPortion(): array
    {
        return [
            ['192.168.112.203', 1, '128.0.0.0', ['128', '0', '0', '0'], '80000000', '10000000000000000000000000000000', 2147483648],
            ['192.168.84.233', 2, '192.0.0.0', ['192', '0', '0', '0'], 'C0000000', '11000000000000000000000000000000', 3221225472],
            ['10.10.122.113', 3, '0.0.0.0', ['0', '0', '0', '0'], '00000000', '00000000000000000000000000000000', 0],
            ['255.255.255.255', 4, '240.0.0.0', ['240', '0', '0', '0'], 'F0000000', '11110000000000000000000000000000', 4026531840],
            ['192.168.112.207', 5, '192.0.0.0', ['192', '0', '0', '0'], 'C0000000', '11000000000000000000000000000000', 3221225472],
            ['192.128.0.1', 6, '192.0.0.0', ['192', '0', '0', '0'], 'C0000000', '11000000000000000000000000000000', 3221225472],
            ['128.0.0.0', 7, '128.0.0.0', ['128', '0', '0', '0'], '80000000', '10000000000000000000000000000000', 2147483648],
            ['235.90.125.222', 8, '235.0.0.0', ['235', '0', '0', '0'], 'EB000000', '11101011000000000000000000000000', 3942645760],
            ['208.153.158.185', 9, '208.128.0.0', ['208', '128', '0', '0'], 'D0800000', '11010000100000000000000000000000', 3498049536],
            ['99.107.189.17', 10, '99.64.0.0', ['99', '64', '0', '0'], '63400000', '01100011010000000000000000000000', 1665138688],
            ['233.126.142.167', 11, '233.96.0.0', ['233', '96', '0', '0'], 'E9600000', '11101001011000000000000000000000', 3915382784],
            ['205.39.43.86', 12, '205.32.0.0', ['205', '32', '0', '0'], 'CD200000', '11001101001000000000000000000000', 3441426432],
            ['158.114.74.115', 13, '158.112.0.0', ['158', '112', '0', '0'], '9E700000', '10011110011100000000000000000000', 2658140160],
            ['127.132.3.128', 14, '127.132.0.0', ['127', '132', '0', '0'], '7F840000', '01111111100001000000000000000000', 2139357184],
            ['243.73.87.101', 15, '243.72.0.0', ['243', '72', '0', '0'], 'F3480000', '11110011010010000000000000000000', 4081582080],
            ['176.103.67.129', 16, '176.103.0.0', ['176', '103', '0', '0'], 'B0670000', '10110000011001110000000000000000', 2959540224],
            ['190.113.28.0', 17, '190.113.0.0', ['190', '113', '0', '0'], 'BE710000', '10111110011100010000000000000000', 3195076608],
            ['204.243.103.224', 18, '204.243.64.0', ['204', '243', '64', '0'], 'CCF34000', '11001100111100110100000000000000', 3438493696],
            ['203.247.20.148', 19, '203.247.0.0', ['203', '247', '0', '0'], 'CBF70000', '11001011111101110000000000000000', 3421962240],
            ['15.254.55.4', 20, '15.254.48.0', ['15', '254', '48', '0'], '0FFE3000', '00001111111111100011000000000000', 268316672],
            ['96.245.55.29', 21, '96.245.48.0', ['96', '245', '48', '0'], '60F53000', '01100000111101010011000000000000', 1626681344],
            ['88.102.195.7', 22, '88.102.192.0', ['88', '102', '192', '0'], '5866C000', '01011000011001101100000000000000', 1483128832],
            ['144.60.195.68', 23, '144.60.194.0', ['144', '60', '194', '0'], '903CC200', '10010000001111001100001000000000', 2419900928],
            ['189.191.237.105', 24, '189.191.237.0', ['189', '191', '237', '0'], 'BDBFED00', '10111101101111111110110100000000', 3183471872],
            ['98.79.29.150', 25, '98.79.29.128', ['98', '79', '29', '128'], '624F1D80', '01100010010011110001110110000000', 1649352064],
            ['56.5.145.126', 26, '56.5.145.64', ['56', '5', '145', '64'], '38059140', '00111000000001011001000101000000', 939888960],
            ['80.170.127.173', 27, '80.170.127.160', ['80', '170', '127', '160'], '50AA7FA0', '01010000101010100111111110100000', 1353351072],
            ['92.123.10.117', 28, '92.123.10.112', ['92', '123', '10', '112'], '5C7B0A70', '01011100011110110000101001110000', 1551567472],
            ['88.52.155.198', 29, '88.52.155.192', ['88', '52', '155', '192'], '58349BC0', '01011000001101001001101111000000', 1479842752],
            ['230.233.123.40', 30, '230.233.123.40', ['230', '233', '123', '40'], 'E6E97B28', '11100110111010010111101100101000', 3874061096],
            ['254.17.211.42', 31, '254.17.211.42', ['254', '17', '211', '42'], 'FE11D32A', '11111110000100011101001100101010', 4262581034],
            ['57.51.231.108', 32, '57.51.231.108', ['57', '51', '231', '108'], '3933E76C', '00111001001100111110011101101100', 959702892],
        ];
    }

    /* ************************** *
     * MASK PREFIX VALIDATION
     * ************************** */

    #[Test]
    public function testSubnetMaskAcceptsZeroPrefix(): void
    {
        // Given
        $prefix = 0;

        // When
        $mask = new \IPv4\SubnetMask($prefix);

        // Then
        $this->assertSame(0, $mask->asInteger());
        $this->assertSame('0.0.0.0', $mask->asQuads());
        $this->assertSame(0, $mask->prefix());
    }

    #[Test]
    public function testWildcardMaskAcceptsZeroPrefix(): void
    {
        // Given
        $prefix = 0;

        // When
        $mask = new \IPv4\WildcardMask($prefix);

        // Then
        $this->assertSame(0xFFFFFFFF, $mask->asInteger());
        $this->assertSame('255.255.255.255', $mask->asQuads());
        $this->assertSame(0, $mask->prefix());
    }

    #[Test]
    public function testSlashZeroSubnetProperties(): void
    {
        // Given
        $subnet = Subnet::fromCidr('0.0.0.0/0');

        // Then - Network properties
        $this->assertSame('0.0.0.0', $subnet->networkAddress()->asQuads());
        $this->assertSame('255.255.255.255', $subnet->broadcastAddress()->asQuads());
        $this->assertSame('0.0.0.0', $subnet->mask()->asQuads());
        $this->assertSame('255.255.255.255', $subnet->wildcardMask()->asQuads());
        $this->assertSame(0, $subnet->networkSize());

        // Then - Address counts
        $this->assertSame(4_294_967_296, $subnet->addressCount());
        $this->assertSame(4_294_967_294, $subnet->hostCount());

        // Then - Host range
        $this->assertSame('0.0.0.1', $subnet->minHost()->asQuads());
        $this->assertSame('255.255.255.254', $subnet->maxHost()->asQuads());
    }

    #[Test]
    public function testSlashZeroContainsAnyIpAddress(): void
    {
        // Given
        $subnet = Subnet::fromCidr('0.0.0.0/0');

        // Then
        $this->assertTrue($subnet->containsIP('0.0.0.0'));
        $this->assertTrue($subnet->containsIP('127.0.0.1'));
        $this->assertTrue($subnet->containsIP('192.168.1.1'));
        $this->assertTrue($subnet->containsIP('255.255.255.255'));
    }
}
